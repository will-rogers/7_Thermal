d1 <- dat %>% filter(Date %in% 44845)
d2 <- dat %>% filter(Date %in% 44846)
d3 <- dat %>% filter(Date %in% 44847)
d1.2 <- dat %>% filter(Date %in% 44845:44846)
d2.3 <- dat %>% filter(Date %in% 44846:44847)
d1.3 <- dat %>% filter(Date %in% c(44845,44847))
d1.2.3 <- dat %>% filter(Date %in% 44845:44847)
df.list <- list(d1, d2, d3, d1.2, d2.3, d1.3, d1.2.3)
eye.results <- lapply(df.list, function(x) {
lm(Rectal ~ value, data = x %>%
filter(body.part == "Eye") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T) %>%
filter(!is.na(value)))
})
flank.results <- lapply(df.list, function(x) {
lm(Rectal ~ value, data = x %>%
filter(body.part == "Flank")%>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T))
})
inner.results <- lapply(df.list, function(x) {
lm(Rectal ~ value, data = x %>%
filter(body.part == "InnerEar")%>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T))
})
outer.results <- lapply(df.list, function(x) {
lm(Rectal ~ value, data = x %>%
filter(body.part == "OuterEar") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T))
})
mod.list <- list(eye.results, flank.results, inner.results, outer.results)
bound <- rbindlist(lapply(mod.list, function(x){
inner.join <- lapply(x, function(y){
d <- summary(y)
d$r.squared
})
inner.joina <- lapply(x, function(y){
nobs(y)
})
tibble(r2 = unlist(inner.join),
obs = inner.joina,
dataset = c("d1", "d2", "d3", "d1.2", "d2.3", "d1.3", "d1.2.3"))
}))
bound$bodypart = rep(c("eye","flank","inner","outer"), each = length(df.list))
bound$days = rep(c(1,1,1,2,2,2,3), 4)
bound %>%
filter(obs > 1) %>%
ggplot(aes(x = factor(days), y = r2)) +
geom_violin() +
geom_point(aes(color = dataset)) +
facet_wrap(. ~ bodypart) +
labs(x = "Number of Sampling Days",
y = "Prop. Var in Rectal Explained\nby Body Part on WalkWay")
corrplot(cap[,-1])
library(corrplot)
corrplot(cap[,-1])
cap[,-1]
corrplot(cor(cap[,-1]))
corrplot(cor(cap[,-1], use = "pairwise.complete"))
plot(cap[,-1])
merged <- merge(rep.long, cap, by.x = "Animal", by.y = "ID")
dat <- merged %>% filter(Date %in% 44845:44847)
d1 <- dat %>% filter(Date %in% 44845)
d2 <- dat %>% filter(Date %in% 44846)
d3 <- dat %>% filter(Date %in% 44847)
d1.2 <- dat %>% filter(Date %in% 44845:44846)
d2.3 <- dat %>% filter(Date %in% 44846:44847)
d1.3 <- dat %>% filter(Date %in% c(44845,44847))
d1.2.3 <- dat %>% filter(Date %in% 44845:44847)
df.list <- list(d1, d2, d3, d1.2, d2.3, d1.3, d1.2.3)
eye.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "Eye") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$Rectal)
})
flank.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "Flank") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$Rectal)
})
inner.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "InnerEar") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$Rectal)
})
outer.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "OuterEar") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$Rectal)
})
mod.list <- list(eye.results, flank.results, inner.results, outer.results)
rbindlist(lapply(mod.list, function(x){
inner.join <- lapply(x, function(y){
y
})
inner.joina <- lapply(x, function(y){
nobs(y)
})
tibble(r2 = unlist(inner.join),
obs = inner.joina,
dataset = c("d1", "d2", "d3", "d1.2", "d2.3", "d1.3", "d1.2.3"))
}))
bound <- rbindlist(lapply(mod.list, function(x){
inner.join <- lapply(x, function(y){
y
})
tibble(r2 = unlist(inner.join),
obs = inner.joina,
dataset = c("d1", "d2", "d3", "d1.2", "d2.3", "d1.3", "d1.2.3"))
}))
bound <- rbindlist(lapply(mod.list, function(x){
inner.join <- lapply(x, function(y){
y
})
tibble(r2 = unlist(inner.join),
dataset = c("d1", "d2", "d3", "d1.2", "d2.3", "d1.3", "d1.2.3"))
}))
bound$bodypart = rep(c("eye","flank","inner","outer"), each = length(df.list))
bound$days = rep(c(1,1,1,2,2,2,3), 4)
bound %>%
ggplot(aes(x = factor(days), y = r2)) +
geom_violin() +
geom_point(aes(color = dataset)) +
facet_wrap(. ~ bodypart) +
labs(x = "Number of Sampling Days",
y = "Prop. Var in Rectal Explained\nby Body Part on WalkWay")
bound
mod.list[[1]][[1]]
mod.list[[1]]
merged <- merge(rep.long, cap, by.x = "Animal", by.y = "ID")
dat <- merged %>% filter(Date %in% 44845:44847)
d1 <- dat %>% filter(Date %in% 44845)
d2 <- dat %>% filter(Date %in% 44846)
d3 <- dat %>% filter(Date %in% 44847)
d1.2 <- dat %>% filter(Date %in% 44845:44846)
d2.3 <- dat %>% filter(Date %in% 44846:44847)
d1.3 <- dat %>% filter(Date %in% c(44845,44847))
d1.2.3 <- dat %>% filter(Date %in% 44845:44847)
df.list <- list(d1, d2, d3, d1.2, d2.3, d1.3, d1.2.3)
eye.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "Eye") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$Rectal, use = "pairwise.complete")
})
flank.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "Flank") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$Rectal, use = "pairwise.complete")
})
inner.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "InnerEar") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$Rectal, use = "pairwise.complete")
})
outer.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "OuterEar") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$Rectal, use = "pairwise.complete")
})
mod.list <- list(eye.results, flank.results, inner.results, outer.results)
mod.list[[1]]
bound <- rbindlist(lapply(mod.list, function(x){
inner.join <- lapply(x, function(y){
y
})
tibble(cor = unlist(inner.join),
dataset = c("d1", "d2", "d3", "d1.2", "d2.3", "d1.3", "d1.2.3"))
}))
bound$bodypart = rep(c("eye","flank","inner","outer"), each = length(df.list))
bound$days = rep(c(1,1,1,2,2,2,3), 4)
bound %>%
ggplot(aes(x = factor(days), y = cor)) +
geom_violin() +
geom_point(aes(color = dataset)) +
facet_wrap(. ~ bodypart) +
labs(x = "Number of Sampling Days",
y = "Prop. Var in Rectal Explained\nby Body Part on WalkWay")
bound %>%
ggplot(aes(x = factor(days), y = cor)) +
geom_violin() +
geom_point(aes(color = dataset)) +
facet_wrap(. ~ bodypart) +
labs(x = "Number of Sampling Days",
y = "Prop. Var in Rectal Explained\nby Body Part on WalkWay") +
geom_hline(yintercept = 0, size = 1) +
theme_classic()
merged <- merge(rep.long, cap, by.x = "Animal", by.y = "ID")
dat <- merged %>% filter(Date %in% 44845:44847) %>% mutate(mean.ear = mean(LIE, RIE, na.rm = T))
merged <- merge(rep.long, cap, by.x = "Animal", by.y = "ID")
dat <- merged %>% filter(Date %in% 44845:44847) %>% mutate(mean.ear = mean(LIE, RIE, na.rm = T))
merged <- merge(rep.long, cap, by.x = "Animal", by.y = "ID")
dat <- merged %>% filter(Date %in% 44845:44847) %>% mutate(mean.ear = mean(c(LIE, RIE), na.rm = T))
d1 <- dat %>% filter(Date %in% 44845)
d2 <- dat %>% filter(Date %in% 44846)
d3 <- dat %>% filter(Date %in% 44847)
d1.2 <- dat %>% filter(Date %in% 44845:44846)
d2.3 <- dat %>% filter(Date %in% 44846:44847)
d1.3 <- dat %>% filter(Date %in% c(44845,44847))
d1.2.3 <- dat %>% filter(Date %in% 44845:44847)
df.list <- list(d1, d2, d3, d1.2, d2.3, d1.3, d1.2.3)
eye.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "Eye") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$mean.ear, use = "pairwise.complete")
})
flank.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "Flank") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$mean.ear, use = "pairwise.complete")
})
inner.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "InnerEar") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$mean.ear, use = "pairwise.complete")
})
outer.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "OuterEar") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$mean.ear, use = "pairwise.complete")
})
mod.list <- list(eye.results, flank.results, inner.results, outer.results)
dat
merged <- merge(rep.long, cap, by.x = "Animal", by.y = "ID")
dat <- merged %>%
filter(Date %in% 44845:44847) %>%
group_by(Animal) %>%
mutate(mean.ear = mean(c(LIE, RIE), na.rm = T))
d1 <- dat %>% filter(Date %in% 44845)
d2 <- dat %>% filter(Date %in% 44846)
d3 <- dat %>% filter(Date %in% 44847)
d1.2 <- dat %>% filter(Date %in% 44845:44846)
d2.3 <- dat %>% filter(Date %in% 44846:44847)
d1.3 <- dat %>% filter(Date %in% c(44845,44847))
d1.2.3 <- dat %>% filter(Date %in% 44845:44847)
df.list <- list(d1, d2, d3, d1.2, d2.3, d1.3, d1.2.3)
eye.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "Eye") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$mean.ear, use = "pairwise.complete")
})
flank.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "Flank") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$mean.ear, use = "pairwise.complete")
})
inner.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "InnerEar") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$mean.ear, use = "pairwise.complete")
})
outer.results <- lapply(df.list, function(x) {
tmp.data <- x %>%
filter(body.part == "OuterEar") %>%
group_by(Animal) %>%
mutate(value = mean(value, na.rm = T)) %>%
distinct(Animal, .keep_all = T)
cor(tmp.data$value, tmp.data$mean.ear, use = "pairwise.complete")
})
mod.list <- list(eye.results, flank.results, inner.results, outer.results)
bound <- rbindlist(lapply(mod.list, function(x){
inner.join <- lapply(x, function(y){
y
})
tibble(cor = unlist(inner.join),
dataset = c("d1", "d2", "d3", "d1.2", "d2.3", "d1.3", "d1.2.3"))
}))
bound$bodypart = rep(c("eye","flank","inner","outer"), each = length(df.list))
bound$days = rep(c(1,1,1,2,2,2,3), 4)
bound %>%
ggplot(aes(x = factor(days), y = cor)) +
geom_violin() +
geom_point(aes(color = dataset)) +
facet_wrap(. ~ bodypart) +
labs(x = "Number of Sampling Days",
y = "Prop. Var in Rectal Explained\nby Body Part on WalkWay") +
geom_hline(yintercept = 0, size = 1) +
theme_classic()
corrplot(cor(cap[,-1], use = "pairwise.complete"))
plot(cap[,-1])
install.packages("pdftools")
# install.packages("pdftools")
library(pdftools)
# install.packages("pdftools")
library(pdftools)
install.packages("qpdf")
library(pdftools)
install.packages("qpdf")
library(pdftools)
install.packages("pdftools")
# install.packages("pdftools")
library(pdftools)
install.packages("pdftools")
install.packages("pdftools")
install.packages("pdftools")
require(tidyverse)
read("~/Downloads/flir.txt")
require(readr)
txt <- read.csv("~/Downloads/flir.txt")
txt <- read.csv("/Downloads/flir.txt")
setwd("~/Downloads")
txt <- read.csv("flir.txt")
setwd("~/Downloads")
require(tidyverse)
require(readr)
txt <- read.csv("flir.txt")
txt <- read.table("flir.txt")
?read.table
txt <- read.csv("flir.txt", fill = T)
read.csv("flir.txt", fill = T)
txt <- read.csv("flir.txt", fill = T)
txt <- read.csv("flir.txt")
txt <- read.table("flir.txt")
txt <- read.table("flir.txt", fill = T)
txt <- read.table("flir.txt", fill = T)
txtx
txt
<- table(txt$V3)
table(txt$V3)
table(str.detect(txt$V3, ","))
table(str_detect(txt$V3, ","))
max.temp <- which(str_detect(txt$V3, ","))
animal <- table(txt$V1)
animal
animal <- table(txt$V1 %in% c("P04","P13"))
animal
max.temp
install.packages("pdftools")
setwd("~/Downloads")
require(tidyverse)
require(readr)
txt <- read.table("flir.txt", fill = T)
max.temp <- which(str_detect(txt$V3, ","))
max.temp
length(max.temp)
table(str_detect(txt$V1, "FLIR"))
txt
table(str_detect(txt$V2, "FLIR"))
table(str_detect(txt$V2, "FLIR"))
table((str_detect(txt$V3, ",")))
table(str_detect(txt$V2, "FLIR"))
max.temp <- which(str_detect(txt$V3, ","))
diff(max.temp)
table(diff(max.temp)> 3)
diff(max.temp)
txt$V3
max.temp(txt$V3)
txt$V3[max.temp]
txt
max.temp <- which(txt$V1 == "Bx1")
txt$V3[max.temp]
length(txt$V3[max.temp])
as.numeric(txt$V3[max.temp])
?as.numeric(txt$V3[max.temp])
?numeric(txt$V3[max.temp])
numeric(txt$V3[max.temp])
format(txt$V3[max.temp], decimal.mark = '.')
str_replace(txt$V3[max.temp], ",", ".")
as.numeric(str_replace(txt$V3[max.temp], ",", "."))
flir.temp <- as.numeric(str_replace(txt$V3[max.temp], ",", "."))
max.temp.row <- which(txt$V1 == "Bx1")
animal <- table(str_detect(txt$V2, "FLIR"))
max.temp <- as.numeric(str_replace(txt$V3[max.temp.row], ",", "."))
max.temp
max.temp.row
txt$V1
txt$V1 %in% ("P13", "P04", "PO4")
table(txt$V1 %in% c("P13", "P04", "PO4"))
txt$V1[(!txt$V1 %in% c("P13", "P04", "PO4"))]
txt$V1[(!txt$V1 %in% c("P13", "P04", "PO4")) & str_detect(txt$V2, "P")]
txt$V1[(!txt$V1 %in% c("P13", "P04", "PO4")) & str_detect(txt$V2, "p")]
str_detect(txt$V2, "p")
txt$V1[str_detect(txt$V2, "p")]
txt$V1[(!txt$V1 %in% c("P13", "P04", "PO4")) & str_detect(txt$V2, "\\p")]
(!txt$V1 %in% c("P13", "P04", "PO4"))
str_detect(txt$V2, "p")
txt$V2
txt$V1[(!txt$V1 %in% c("P13", "P04", "PO4")) & str_detect(txt$V1, "p")]
txt$V1[(!txt$V1 %in% c("P13", "P04", "PO4")) & !str_detect(txt$V1, "FLIR")]
txt$V1[(txt$V1 %in% c("P13", "P04", "PO4"))]
which(txt$V1 %in% c("P13", "P04", "PO4"))
plot(which(txt$V1 %in% c("P13", "P04", "PO4")), max.temp.row[-49])
which(txt$V1 %in% c("P13", "P04", "PO4"))
txt$V1[419]
txt$V1[415:430]
animal
animal/2
table(str_detect(txt$V1, "FLIR"))
table(txt$V1[which(str_detect(txt$V1, "FLIR"))])
setwd("~/Downloads")
require(tidyverse)
require(readr)
txt <- read.table("flir.txt", fill = T)
max.temp.row <- which(txt$V1 == "Bx1")
photo <- str_detect(txt$V1, "FLIR")
photo <- photo[-length(photo)]
max.temp <- as.numeric(str_replace(txt$V3[max.temp.row], ",", "."))
which(txt$V1 %in% c("P13", "P04", "PO4"))
plot(which(txt$V1 %in% c("P13", "P04", "PO4")), max.temp.row[-49])
table(txt$V1[which(str_detect(txt$V1, "FLIR"))])
max.temp
setwd("~/Desktop")
setwd("~/Downloads")
require(tidyverse)
require(readr)
txt <- read.table("flir.txt", fill = T)
max.temp.row <- which(txt$V1 == "Bx1")
photo <- str_detect(txt$V1, "FLIR")
photo <- photo[-length(photo)]
max.temp <- as.numeric(str_replace(txt$V3[max.temp.row], ",", "."))
DistanceFlirEntry <- read_csv("~/Desktop/DistanceFlirEntry.csv")
photo
txt$V1
photo.ID <- txt$V1[txt$V1]
photo.ID <- txt$V1[photo]
DistanceFlirEntry
df <- tibble(file.number = str_remove(str_remove(photo.ID, "FLIR"), ".jpg"),
Temperature = max.temp)
str_remove(str_remove(photo.ID, "FLIR"), ".jpg")
setwd("~/Downloads")
require(tidyverse)
require(readr)
txt <- read.table("flir.txt", fill = T)
max.temp.row <- which(txt$V1 == "Bx1")
photo <- str_detect(txt$V1, "FLIR")
photo <- photo[-length(photo)]
max.temp <- as.numeric(str_replace(txt$V3[max.temp.row], ",", "."))
photo.ID <- txt$V1[photo]
df <- tibble(file.number = str_remove(str_remove(photo.ID, "FLIR"), ".jpg"),
Temperature = max.temp)
length(photo)
photo <- which(str_detect(txt$V1, "FLIR"))
photo <- photo[-length(photo)]
photo
length(photo)
max.temp <- as.numeric(str_replace(txt$V3[max.temp.row], ",", "."))
photo.ID <- txt$V1[photo]
df <- tibble(file.number = str_remove(str_remove(photo.ID, "FLIR"), ".jpg"),
Temperature = max.temp)
DistanceFlirEntry <- read_csv("~/Desktop/DistanceFlirEntry.csv")
merge(df, DistanceFlirEntry)
df <- tibble(file.number = str_remove(str_remove(photo.ID, "FLIR"), ".jpg"),
Temperature.Script = max.temp)
DistanceFlirEntry <- read_csv("~/Desktop/DistanceFlirEntry.csv")
merged <- merge(df, DistanceFlirEntry)
table(merged$Temperature.Script == merged$Temperature)
length(DistanceFlirEntry$Temperature)
which(merged$Temperature.Script != merged$Temperature)
merged[4,]
install.packages("pdftools")
install.packages("tesseract")
install.packages("tidyverse")
install.packages("here")
install.packages("hunspell")
install.packages("flextable")
library(hunspell)
library(pdftools)
library(tesseract)
library(tidyverse)
library(here)
install.packages(tabulizer)
